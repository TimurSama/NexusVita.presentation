# Инструкция по деплою на Vercel

## Текущая конфигурация

✅ **Всё готово для автоматического деплоя!**

### Что уже настроено:

1. **vercel.json** - конфигурация для Vercel:
   - Build команда: `npm run build:vercel` (только клиент, без сервера)
   - Output directory: `dist/public`
   - Framework: Vite (автоопределение)
   - Rewrites для SPA роутинга
   - Security headers

2. **package.json**:
   - Добавлена команда `build:vercel` для сборки только клиента
   - Обычная команда `build` включает сервер (для локального запуска)

3. **Роутинг**:
   - Автоматическое определение Vercel по домену
   - Base path корректно устанавливается для Vercel (пустой) и GitHub Pages

4. **.vercelignore**:
   - Игнорируются ненужные файлы (server/, логи, кэш)

## Настройка в Vercel Dashboard

### При создании проекта:

1. **Root Directory**: `./` (корень репозитория)
2. **Framework Preset**: Vite (автоопределяется)
3. **Build Command**: `npm run build:vercel` (уже указано в vercel.json)
4. **Output Directory**: `dist/public` (уже указано в vercel.json)
5. **Install Command**: `npm install` (по умолчанию)

### Переменные окружения (опционально):

Если нужны переменные окружения, добавьте их в настройках проекта:
- `VITE_BASE_PATH` - если нужен кастомный base path (по умолчанию "/")
- `VITE_VERCEL=true` - для явного указания, что это Vercel

## Автоматический деплой

✅ **Vercel автоматически деплоит при каждом push в main ветку**

После первого деплоя:
- Каждый push в `main` → автоматический деплой
- Pull Request → Preview деплой
- Можно настроить деплой из других веток в настройках проекта

## Проверка деплоя

После деплоя проверьте:
1. ✅ Главная страница загружается
2. ✅ Роутинг работает (переходы между страницами)
3. ✅ Все страницы доступны
4. ✅ Нет ошибок в консоли браузера

## Возможные проблемы

### Проблема: 404 на всех страницах кроме главной
**Решение**: Убедитесь, что в vercel.json есть rewrites для SPA роутинга (уже настроено)

### Проблема: Неправильный base path
**Решение**: Router автоматически определяет Vercel по домену. Если проблемы, добавьте `VITE_VERCEL=true` в переменные окружения

### Проблема: Build fails
**Решение**: 
- Проверьте, что все зависимости установлены
- Убедитесь, что Node.js версия совместима (Vercel использует последнюю LTS)
- Проверьте логи билда в Vercel Dashboard

## База данных

Для подключения базы данных:
1. В Vercel Dashboard → Storage → Create Database
2. Выберите PostgreSQL или MongoDB
3. Скопируйте connection string
4. Добавьте в Environment Variables как `DATABASE_URL` или `MONGODB_URI`

Подробнее см. `docs/VERCEL_SETUP.md`
