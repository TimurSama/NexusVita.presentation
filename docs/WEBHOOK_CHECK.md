# –ü—Ä–æ–≤–µ—Ä–∫–∞ Webhook –¥–ª—è Telegram –±–æ—Ç–∞

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!

–ë–æ—Ç **–ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨** –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ webhook!

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Telegram Bot API (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_BOT_TOKEN` –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω –∏–∑ BotFather):
```
https://api.telegram.org/botYOUR_BOT_TOKEN/setWebhook?url=https://etholife.vercel.app/api/telegram/webhook
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON: `{"ok":true,"result":true,"description":"Webhook was set"}`

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π endpoint

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ:
```
https://etholife.vercel.app/api/admin/setup-webhook
```
(–ù—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST –∑–∞–ø—Ä–æ—Å, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Postman –∏–ª–∏ curl)

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/mybots`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
4. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "Bot Settings" –∏–ª–∏ "Webhook"
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook URL: `https://etholife.vercel.app/api/telegram/webhook`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook:

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∑–∞–º–µ–Ω–∏—Ç–µ `YOUR_BOT_TOKEN`):
```
https://api.telegram.org/botYOUR_BOT_TOKEN/getWebhookInfo
```

–î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å URL: `https://etholife.vercel.app/api/telegram/webhook`

## –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint webhook-info

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://etholife.vercel.app/api/telegram/webhook-info
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- `success: true`
- `webhookInfo` —Å URL –≤–∞—à–µ–≥–æ webhook
- `botInfo` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±–æ—Ç–µ

–ï—Å–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Vercel

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Vercel Dashboard](https://vercel.com/dashboard)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç `etholife`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Deployments**
4. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
5. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Functions** ‚Üí `api/telegram/webhook` ‚Üí **Logs**
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É
7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏:
   - `=== WEBHOOK CALLED ===`
   - `üöÄ /start command received from:`
   - `‚úÖ Update processed successfully`

### –ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –ù–ï–¢ –∑–∞–ø–∏—Å–µ–π:

- Webhook –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/getwebhookinfo` –≤ BotFather
- –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook

### –ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –ï–°–¢–¨ –∑–∞–ø–∏—Å–∏, –Ω–æ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TELEGRAM_BOT_TOKEN` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables:

- ‚úÖ `TELEGRAM_BOT_TOKEN` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ `DATABASE_URL` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç**!

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. Webhook –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω–∞:** Webhook –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL

**–†–µ—à–µ–Ω–∏–µ:**
```
/deletewebhook
/setwebhook
https://etholife.vercel.app/api/telegram/webhook
```

### 2. –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Vercel –Ω–∞ –æ—à–∏–±–∫–∏

### 3. "TELEGRAM_BOT_TOKEN not set"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ Vercel Environment Variables –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook: `/getwebhookinfo` –≤ BotFather
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint: `https://etholife.vercel.app/api/telegram/webhook-info`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: Vercel Dashboard ‚Üí Functions ‚Üí Logs
4. ‚úÖ –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. –£–¥–∞–ª–∏—Ç–µ webhook: `/deletewebhook` –≤ BotFather
2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Vercel
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ webhook –∑–∞–Ω–æ–≤–æ: `/setwebhook https://etholife.vercel.app/api/telegram/webhook`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ `/start`
